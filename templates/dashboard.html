{% extends 'base.html' %}
{% load static %}
{% block custom_styles %}
<link rel="stylesheet" href="{% static 'styles/dashboard.css' %}">
<link rel="stylesheet" href="{% static 'styles/gauges.css' %}">
{% endblock %}
{% block content %}
<div class="container">
    <div class="row">
        <div class="col-md-9">
            <!-- Contenido de la columna principal -->
            <div class="row mb-3 align-items-stretch">
                <div class="col-md-6 d-flex">
                    <!-- Primera columna de la primera fila -->
                    <div class="card border-0 flex-fill d-flex">
                        <div class="card-body">
                            <h5 class="dashboard-card-title fw-bold">Potencial de hidrogeno (pH)</h5>
                            <div class="row text-center align-items-center justify-content-center">
                                <div class="col-md-3 d-flex justify-content-center align-items-center">
                                    <p class="ph-text fw-bold">{{ last_ph }}</p>
                                </div>
                                <div
                                    class="ph-status col-md-3 d-flex flex-column justify-content-center align-items-center mt-1">
                                    <p class="ph-alcalino {% if last_ph > 8 %}active{% endif %}">Alcalino</p>
                                    <p class="ph-neutro {% if last_ph >= 6.5 and last_ph <= 8 %}active{% endif %}">
                                        Neutro</p>
                                    <p class="ph-acido {% if last_ph < 6.5 %}active{% endif %}">Ácido</p>
                                </div>
                                <div class="col-md-6 d-flex justify-content-center align-items-center">
                                    <img src="{% static 'assets/phImage.svg' %}" alt="pH Icon" class="img-fluid"
                                        width="100">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 d-flex">
                    <!-- Segunda columna de la primera fila -->
                    <div class="card border-0 flex-fill d-flex">
                        <div class="card-body d-flex flex-column">
                            <h5 class="dashboard-card-title fw-bold">Temperatura</h5>
                            <div class="flex-fill d-flex align-items-center justify-content-center gap-3">
                                <div class="d-flex justify-content-center align-items-center">
                                    {% if last_temp > 25 %}
                                    <img src="{% static 'assets/hotTemp.svg' %}" alt="Temperature Icon"
                                        class="img-fluid" width="80">
                                    {% else %}
                                    <img src="{% static 'assets/coldTemp.svg' %}" alt="Temperature Icon"
                                        class="img-fluid" width="80">
                                    {% endif %}
                                </div>
                                <div class="d-flex justify-content-center align-items-center">
                                    <p class="temperature-text fw-bold mb-0">{{ last_temp }} °C</p>
                                </div>
                                <div class="d-flex flex-column justify-content-center align-items-center">
                                    <button class="btn btn-sm mb-1" onclick="changeTemperatureUnit('up')">
                                        <img src="{% static 'assets/up-arrow.svg' %}" alt="Up Arrow" width="16">
                                    </button>
                                    <button class="btn btn-sm" onclick="changeTemperatureUnit('down')">
                                        <img src="{% static 'assets/down-arrow.svg' %}" alt="Down Arrow" width="16">
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row mb-3">
                <div class="col-md-6">
                    <!-- Primera columna de la segunda fila -->
                    <div class="card border-0">
                        <div class="card-body">
                            <h5 class="dashboard-card-title fw-bold">Solidos Disueltos</h5>
                            <div class="row">
                                <div class="col-md-4">
                                    <img src="{% static 'assets/tdsImage.svg' %}" alt="Sólidos Disueltos Icon"
                                        class="img-fluid" width="100">
                                </div>
                                <div class="col-md-8 d-flex align-items-center">
                                    <p class="tds-text fw-bold mb-0">{{ last_tds }} ppm</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <!-- Segunda columna de la segunda fila -->
                    <div class="card border-0">
                        <div class="card-body">
                            <h5 class="dashboard-card-title fw-bold">Conductividad Electrica</h5>
                            <div class="row">
                                <div class="col-md-4">
                                    <img src="{% static 'assets/ecImage.svg' %}" alt="Sólidos Disueltos Icon"
                                        class="img-fluid" width="100">
                                </div>
                                <div class="col-md-8 d-flex align-items-center">
                                    <p class="tds-text fw-bold mb-0">{{ last_ec }} mS/cm</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <!-- Columna única de la tercera fila -->
                    <div class="card border-0">
                        <div class="card-body">
                            <h5 class="card-title">Primera Columna</h5>
                            <p class="card-text">Contenido de la primera columna de la primera fila.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <!-- Contenido de la columna secundaria -->
            <div class="card border-0">
                <div class="card-body">
                    <h5 class="card-title">Primera Columna</h5>
                    <p class="card-text">Contenido de la primera columna de la primera fila.</p>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- <div class="container">
    
    <div class="gauge-container row text-center">
        <h2>Mediciones Actuales</h2>

        <!-- Gauge de Temperatura -->
<!-- <div class="col-md-4">
            <h3>Temperatura</h3>
            <div id="temperature-gauge">
                <svg width="300" height="150"></svg>
            </div>
        </div>

        <!-- Gauge de Sólidos Disueltos -->
<!-- <div class="col-md-4">
            <h3>Sólidos Disueltos</h3>
            <div id="tds-gauge">
                <svg width="300" height="150"></svg>
            </div>
        </div>

        <!-- Gauge de pH -->
<!-- <div class="col-md-4">
            <h3>pH</h3>
            <div id="ph-gauge">
                <svg width="300" height="150"></svg>
            </div>
        </div>
    </div>

    <h2>Historial de Mediciones</h2>
    <div id="grafica-temp"></div>
    <div id="grafica-ph"></div>
    <div id="grafica-tds"></div>
</div> -->
{% endblock %}
{% block custom_scripts %}
<script src="{% static 'scripts/temperature.js' %}"></script>
<!-- Load d3.js -->
<script src="https://d3js.org/d3.v6.js"></script>
<script src="{% static 'scripts/charts.js' %}"></script>
<script id="mediciones-data" type="application/json">
        {{ data|safe }}
    </script>
<script>
    function updateDateTime() {
        const now = new Date();
        const options = {
            hour: 'numeric',
            minute: 'numeric',
            hour12: true,
            hourCycle: 'h12'
        };
        const dateOptions = {
            weekday: 'long',
            year: 'numeric',
            month: 'short',
            day: 'numeric',
        };
        let time = now.toLocaleTimeString('es-ES', options);
        time = time.replace('a. m.', 'AM').replace('p. m.', 'PM');
        const date = now.toLocaleDateString('es-ES', dateOptions);
        const capitalizedDate = date.charAt(0).toUpperCase() + date.slice(1);
        document.getElementById('datetime').textContent = `${time}      ${capitalizedDate}`;
    }
    setInterval(updateDateTime, 1000);
    updateDateTime();
</script>
{% endblock %}